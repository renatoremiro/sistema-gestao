<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Gestão - DEV v6.2 Modular</title>
    
    <!-- ✅ CSS MODULARIZADO - APENAS OS CRIADOS -->
    <link rel="stylesheet" href="assets/css/main.css">
    <link rel="stylesheet" href="assets/css/calendar.css">
    <link rel="stylesheet" href="modules/chat-styles.css">
    
    <!-- ✅ BIBLIOTECAS EXTERNAS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    
    <!-- ✅ FIREBASE SCRIPTS -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    
    <!-- ✅ SISTEMA MODULARIZADO - APENAS MÓDULOS JÁ CRIADOS -->
    
    <!-- 1. CONFIGURAÇÕES -->
    <script src="assets/js/config/firebase.js"></script>
    
    <!-- 2. UTILITÁRIOS -->
    <script src="assets/js/utils/helpers.js"></script>
    <script src="assets/js/utils/validation.js"></script>
    <script src="assets/js/utils/notifications.js"></script>
    
    <!-- 3. CORE DO SISTEMA -->
    <script src="assets/js/core/data.js"></script>
    <script src="assets/js/core/app.js"></script>
    
    <!-- 4. MÓDULOS FUNCIONAIS -->
    <script src="assets/js/modules/persistence.js"></script>
    <script src="assets/js/modules/auth.js"></script>
    
    <!-- 4. CHAT EXISTENTE -->
    <script src="modules/chat-module.js"></script>
</head>
<body>
    <!-- ✅ SISTEMA DE NOTIFICAÇÕES -->
    <div id="notification" class="notification">
        <span id="notificationText"></span>
    </div>
    
    <!-- ✅ HEADER DE DESENVOLVIMENTO -->
    <div class="container">
        <div class="header">
            <div>
                <h1>🔧 Sistema de Gestão - DESENVOLVIMENTO</h1>
                <p>Obra 292 - Museu Nacional</p>
                <p style="font-size: 14px; color: #6b7280;">
                    <strong>v6.2 Modular - Modo Desenvolvimento (85% Completo)</strong>
                    <span style="background: #10b981; color: white; padding: 2px 8px; border-radius: 4px; margin-left: 8px;">
                        Core + Auth ✅
                    </span>
                </p>
            </div>
            <div style="text-align: right;">
                <p id="dataAtual" style="color: #6b7280;"></p>
                <div style="margin-top: 8px;">
                    <button class="btn btn-primary btn-sm" onclick="testarNotificacoes()">
                        🔔 Teste Notificações
                    </button>
                    <button class="btn btn-success btn-sm" onclick="testarValidacao()">
                        ✅ Teste Validação
                    </button>
                    <button class="btn btn-warning btn-sm" onclick="testarHelpers()">
                        🔧 Teste Helpers
                    </button>
                </div>
            </div>
        </div>
        
        <!-- ✅ STATUS DOS MÓDULOS -->
        <div class="card">
            <h3>📦 Status dos Módulos v6.2</h3>
            <div class="grid">
                <div class="card">
                    <h4 style="color: #10b981;">✅ MÓDULOS CRIADOS</h4>
                    <ul style="list-style: none; padding: 0; line-height: 1.8;">
                        <li>✅ <strong>CSS:</strong> main.css, calendar.css</li>
                        <li>✅ <strong>Config:</strong> firebase.js</li>
                        <li>✅ <strong>Utils:</strong> helpers.js, validation.js, notifications.js</li>
                        <li>✅ <strong>Core:</strong> data.js, app.js</li>
                        <li>✅ <strong>Modules:</strong> persistence.js, auth.js ⭐ <span style="color: #10b981;">NOVO</span></li>
                        <li>✅ <strong>Chat:</strong> chat-module.js (existente)</li>
                    </ul>
                </div>
                
                <div class="card">
                    <h4 style="color: #f59e0b;">🔄 MÓDULOS PENDENTES</h4>
                    <ul style="list-style: none; padding: 0; line-height: 1.8;">
                        <li>🔄 <strong>Modules:</strong> calendar.js</li>
                        <li>🔄 <strong>Modules:</strong> events.js</li>
                        <li>🔄 <strong>Modules:</strong> tasks.js</li>
                        <li>🔄 <strong>Modules:</strong> pdf.js</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <!-- ✅ ÁREA DE TESTES -->
        <div class="card">
            <h3>🧪 Área de Testes dos Módulos</h3>
            
            <!-- Teste de Notificações -->
            <div style="margin-bottom: 20px; padding: 16px; background: #f9fafb; border-radius: 8px;">
                <h4>🔔 Sistema de Notificações</h4>
                <div style="display: flex; gap: 8px; flex-wrap: wrap; margin-top: 8px;">
                    <button class="btn btn-success btn-sm" onclick="Notifications.success('Teste de sucesso!')">
                        Success
                    </button>
                    <button class="btn btn-danger btn-sm" onclick="Notifications.error('Teste de erro!')">
                        Error
                    </button>
                    <button class="btn btn-warning btn-sm" onclick="Notifications.warning('Teste de aviso!')">
                        Warning
                    </button>
                    <button class="btn btn-primary btn-sm" onclick="Notifications.info('Teste de info!')">
                        Info
                    </button>
                    <button class="btn btn-secondary btn-sm" onclick="testarNotificacaoToast()">
                        Toast Múltiplos
                    </button>
                </div>
            </div>
            
            <!-- Teste de Validação -->
            <div style="margin-bottom: 20px; padding: 16px; background: #f9fafb; border-radius: 8px;">
                <h4>✅ Sistema de Validação</h4>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 8px;">
                    <div>
                        <label>Email para validar:</label>
                        <input type="email" id="testeEmail" placeholder="teste@exemplo.com" style="width: 100%; padding: 8px; margin-top: 4px;">
                    </div>
                    <div>
                        <label>Data para validar:</label>
                        <input type="date" id="testeData" style="width: 100%; padding: 8px; margin-top: 4px;">
                    </div>
                </div>
                <div style="margin-top: 12px;">
                    <button class="btn btn-primary btn-sm" onclick="testarValidacaoCompleta()">
                        Validar Campos
                    </button>
                    <span id="resultadoValidacao" style="margin-left: 12px; font-weight: bold;"></span>
                </div>
            </div>
            
            <!-- Teste de Helpers -->
            <div style="margin-bottom: 20px; padding: 16px; background: #f9fafb; border-radius: 8px;">
                <h4>🔧 Utilitários (Helpers)</h4>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 8px;">
                    <div>
                        <label>Texto para formatar:</label>
                        <input type="text" id="textoHelper" placeholder="Digite algo aqui..." style="width: 100%; padding: 8px; margin-top: 4px;">
                    </div>
                    <div>
                        <label>Resultado:</label>
                        <div id="resultadoHelper" style="padding: 8px; background: white; border: 1px solid #d1d5db; border-radius: 4px; margin-top: 4px; min-height: 20px;"></div>
                    </div>
                </div>
                <div style="margin-top: 12px;">
                    <button class="btn btn-primary btn-sm" onclick="testarHelperFormatacao()">
                        Capitalizar
                    </button>
                    <button class="btn btn-secondary btn-sm" onclick="testarHelperSlug()">
                        Gerar Slug
                    </button>
                    <button class="btn btn-warning btn-sm" onclick="testarHelperTruncate()">
                        Truncar (20 chars)
                    </button>
                </div>
            </div>
            
            <!-- Teste de Estrutura de Dados -->
            <div style="margin-bottom: 20px; padding: 16px; background: #f9fafb; border-radius: 8px;">
                <h4>📊 Estrutura de Dados</h4>
                <div style="margin-top: 8px;">
                    <button class="btn btn-primary btn-sm" onclick="testarEstruturaSimples()">
                        Inicializar Dados
                    </button>
                    <button class="btn btn-success btn-sm" onclick="testarPessoas()">
                        Listar Pessoas
                    </button>
                    <button class="btn btn-warning btn-sm" onclick="testarEstatisticas()">
                        Calcular Stats
                    </button>
                </div>
                <div id="resultadoDados" style="margin-top: 12px; padding: 8px; background: white; border: 1px solid #d1d5db; border-radius: 4px; max-height: 200px; overflow-y: auto;"></div>
            </div>
            
            <!-- Teste de Sistema de Persistência -->
            <div style="margin-bottom: 20px; padding: 16px; background: #f0f9ff; border: 1px solid #0ea5e9; border-radius: 8px;">
                <h4>💾 Sistema de Persistência Ultra-Robusta</h4>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 8px;">
                    <div>
                        <button class="btn btn-primary btn-sm" onclick="testarSalvamentoPadrao()">
                            💾 Salvamento Padrão
                        </button>
                        <button class="btn btn-success btn-sm" onclick="testarSalvamentoCritico()">
                            ⚡ Salvamento Crítico
                        </button>
                    </div>
                    <div>
                        <button class="btn btn-warning btn-sm" onclick="testarBackupLocal()">
                            📂 Backup Local
                        </button>
                        <button class="btn btn-secondary btn-sm" onclick="testarStatusPersistencia()">
                            📊 Status Sistema
                        </button>
                    </div>
                </div>
                <div style="margin-top: 12px;">
                    <button class="btn btn-danger btn-sm" onclick="simularFalhaSalvamento()">
                        🚨 Simular Falha (Teste Modal)
                    </button>
                    <button class="btn btn-pdf btn-sm" onclick="testarConectividade()">
                        🌐 Verificar Conectividade
                    </button>
                </div>
                <div id="resultadoPersistencia" style="margin-top: 12px; padding: 8px; background: white; border: 1px solid #d1d5db; border-radius: 4px; max-height: 150px; overflow-y: auto; font-family: monospace; font-size: 12px;"></div>
            </div>
            
            <!-- Teste de Sistema de Autenticação -->
            <div style="margin-bottom: 20px; padding: 16px; background: #fdf2f8; border: 1px solid #ec4899; border-radius: 8px;">
                <h4>🔐 Sistema de Autenticação Firebase ⭐ <span style="color: #10b981; font-size: 12px;">NOVO</span></h4>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 8px;">
                    <div>
                        <button class="btn btn-primary btn-sm" onclick="testarStatusAuth()">
                            👤 Status Atual
                        </button>
                        <button class="btn btn-success btn-sm" onclick="testarValidacaoLogin()">
                            ✅ Validar Campos
                        </button>
                    </div>
                    <div>
                        <button class="btn btn-warning btn-sm" onclick="testarModalRegistro()">
                            📝 Modal Registro
                        </button>
                        <button class="btn btn-secondary btn-sm" onclick="testarConfigAuth()">
                            ⚙️ Config Sistema
                        </button>
                    </div>
                </div>
                <div style="margin-top: 12px;">
                    <button class="btn btn-danger btn-sm" onclick="testarBloqueioLogin()">
                        🔒 Simular Bloqueio
                    </button>
                    <button class="btn btn-pdf btn-sm" onclick="testarLimpezaSessao()">
                        🧹 Limpar Sessão
                    </button>
                </div>
                <div id="resultadoAuth" style="margin-top: 12px; padding: 8px; background: white; border: 1px solid #d1d5db; border-radius: 4px; max-height: 150px; overflow-y: auto; font-family: monospace; font-size: 12px;"></div>
            </div>
        </div>
        
        <!-- ✅ LOG DE DESENVOLVIMENTO -->
        <div class="card">
            <h3>📝 Log de Desenvolvimento</h3>
            <div id="logContainer" style="background: #1f2937; color: #e5e7eb; padding: 16px; border-radius: 8px; font-family: monospace; font-size: 12px; max-height: 300px; overflow-y: auto;">
                <div>🔥 Firebase configurado v6.2</div>
                <div>🔧 Helpers v6.2 carregados!</div>
                <div>✅ Sistema de Validação v6.2 carregado!</div>
                <div>🔔 Sistema de Notificações v6.2 carregado!</div>
                <div>📊 Estrutura de Dados v6.2 carregada!</div>
                <div>🚀 Core App v6.2 carregado!</div>
                <div>💾 Sistema de Persistência Ultra-Robusta v6.2 carregado!</div>
                <div>🔐 Sistema de Autenticação Firebase v6.2 carregado!</div>
                <div style="color: #10b981;">✅ Todos os módulos básicos carregados com sucesso!</div>
                <div style="color: #8b5cf6;">🎯 Progresso: 85% da modularização concluída</div>
            </div>
        </div>
    </div>

    <script>
        // ✅ FUNÇÕES DE TESTE PARA DESENVOLVIMENTO
        
        // Atualizar data atual
        document.getElementById('dataAtual').textContent = new Date().toLocaleDateString('pt-BR');
        
        // Teste de notificações simples
        function testarNotificacoes() {
            Notifications.success('Sistema de notificações funcionando!');
        }
        
        // ✅ TESTES DO SISTEMA DE AUTENTICAÇÃO
        function testarStatusAuth() {
            const resultado = document.getElementById('resultadoAuth');
            resultado.innerHTML += '👤 Verificando status de autenticação...<br>';
            
            if (typeof Auth !== 'undefined') {
                const status = Auth.obterStatus();
                resultado.innerHTML += `✅ Módulo Auth carregado<br>`;
                resultado.innerHTML += `• Autenticado: ${status.autenticado ? 'Sim' : 'Não'}<br>`;
                resultado.innerHTML += `• Email: ${status.email || 'N/A'}<br>`;
                resultado.innerHTML += `• Nome: ${status.nome || 'N/A'}<br>`;
                resultado.innerHTML += `• Tentativas: ${status.tentativasLogin}/3<br>`;
                resultado.innerHTML += `• Login em andamento: ${status.loginEmAndamento ? 'Sim' : 'Não'}<br>`;
            } else {
                resultado.innerHTML += '❌ Módulo Auth não encontrado<br>';
            }
        }
        
        function testarValidacaoLogin() {
            const resultado = document.getElementById('resultadoAuth');
            resultado.innerHTML += '✅ Testando validação de login...<br>';
            
            // Testar validações
            const emailInvalido = Auth._validarCamposLogin('email-inválido', '123');
            const emailVazio = Auth._validarCamposLogin('', 'senha123');
            const senhaFraca = Auth._validarCamposLogin('teste@email.com', '123');
            const dadosValidos = Auth._validarCamposLogin('teste@email.com', 'senha123');
            
            resultado.innerHTML += `• Email inválido: ${emailInvalido.valido ? '❌' : '✅'}<br>`;
            resultado.innerHTML += `• Email vazio: ${emailVazio.valido ? '❌' : '✅'}<br>`;
            resultado.innerHTML += `• Senha fraca: ${senhaFraca.valido ? '❌' : '✅'}<br>`;
            resultado.innerHTML += `• Dados válidos: ${dadosValidos.valido ? '✅' : '❌'}<br>`;
        }
        
        function testarModalRegistro() {
            const resultado = document.getElementById('resultadoAuth');
            resultado.innerHTML += '📝 Abrindo modal de registro...<br>';
            
            Auth.mostrarRegistro();
            resultado.innerHTML += '✅ Modal de registro criado<br>';
            resultado.innerHTML += '💡 Verifique se modal apareceu na tela<br>';
        }
        
        function testarConfigAuth() {
            const resultado = document.getElementById('resultadoAuth');
            resultado.innerHTML += '⚙️ Verificando configurações...<br>';
            
            resultado.innerHTML += `• Timeout login: ${Auth.config.TIMEOUT_LOGIN}ms<br>`;
            resultado.innerHTML += `• Max tentativas: ${Auth.config.MAX_TENTATIVAS_LOGIN}<br>`;
            resultado.innerHTML += `• Auto redirect: ${Auth.config.AUTO_REDIRECT_DELAY}ms<br>`;
            resultado.innerHTML += `• Lembrar usuário: ${Auth.config.REMEMBER_USER ? 'Sim' : 'Não'}<br>`;
        }
        
        function testarBloqueioLogin() {
            const resultado = document.getElementById('resultadoAuth');
            resultado.innerHTML += '🔒 Simulando bloqueio de login...<br>';
            
            // Simular muitas tentativas
            Auth.state.tentativasLogin = Auth.config.MAX_TENTATIVAS_LOGIN;
            Auth._bloquearLogin();
            
            resultado.innerHTML += '⚠️ Login bloqueado por 5 minutos<br>';
            resultado.innerHTML += '💡 Verifique se botão de login foi desabilitado<br>';
        }
        
        function testarLimpezaSessao() {
            const resultado = document.getElementById('resultadoAuth');
            resultado.innerHTML += '🧹 Testando limpeza de sessão...<br>';
            
            Auth._limparSessaoLocal();
            Auth._limparCamposLogin();
            
            resultado.innerHTML += '✅ Sessão local limpa<br>';
            resultado.innerHTML += '✅ Campos de login limpos<br>';
        }
        
        // Teste de notificações múltiplas
        function testarNotificacaoToast() {
            Notifications.mostrarNotificacaoToast('Toast 1', 'success');
            setTimeout(() => Notifications.mostrarNotificacaoToast('Toast 2', 'warning'), 500);
            setTimeout(() => Notifications.mostrarNotificacaoToast('Toast 3', 'error'), 1000);
            setTimeout(() => Notifications.mostrarNotificacaoToast('Toast 4', 'info'), 1500);
        }
        
        // Teste de validação
        function testarValidacao() {
            const email = 'teste@exemplo.com';
            const resultado = Validation.isValidEmail(email);
            Notifications.info(`Email "${email}" é ${resultado ? 'válido' : 'inválido'}`);
        }
        
        function testarValidacaoCompleta() {
            const email = document.getElementById('testeEmail').value;
            const data = document.getElementById('testeData').value;
            const resultado = document.getElementById('resultadoValidacao');
            
            const emailValido = Validation.isValidEmail(email);
            const dataValida = Validation.isValidDate(data);
            
            resultado.innerHTML = `Email: ${emailValido ? '✅' : '❌'} | Data: ${dataValida ? '✅' : '❌'}`;
            resultado.style.color = (emailValido && dataValida) ? '#10b981' : '#ef4444';
        }
        
        // Teste de helpers
        function testarHelpers() {
            const texto = 'olá mundo!';
            const resultado = Helpers.capitalize(texto);
            Notifications.info(`"${texto}" → "${resultado}"`);
        }
        
        function testarHelperFormatacao() {
            const texto = document.getElementById('textoHelper').value || 'exemplo de texto';
            const resultado = Helpers.capitalize(texto);
            document.getElementById('resultadoHelper').textContent = resultado;
        }
        
        function testarHelperSlug() {
            const texto = document.getElementById('textoHelper').value || 'Texto com Acentos e Espaços!';
            const resultado = Helpers.toSlug(texto);
            document.getElementById('resultadoHelper').textContent = resultado;
        }
        
        function testarHelperTruncate() {
            const texto = document.getElementById('textoHelper').value || 'Este é um texto muito longo que será truncado';
            const resultado = Helpers.truncateText(texto, 20);
            document.getElementById('resultadoHelper').textContent = resultado;
        }
        
        // Teste de estrutura de dados
        function testarEstruturaSimples() {
            const dados = DataStructure.inicializarDados();
            const resultado = document.getElementById('resultadoDados');
            resultado.innerHTML = `
                <strong>Dados inicializados:</strong><br>
                • Versão: ${dados.versao}<br>
                • Áreas: ${Object.keys(dados.areas).length}<br>
                • Eventos: ${dados.eventos.length}<br>
                • Última atualização: ${new Date(dados.ultimaAtualizacao).toLocaleString('pt-BR')}
            `;
        }
        
        function testarPessoas() {
            const dados = DataStructure.inicializarDados();
            const pessoas = DataStructure.obterTodasPessoas(dados);
            const resultado = document.getElementById('resultadoDados');
            resultado.innerHTML = `
                <strong>Pessoas encontradas (${pessoas.length}):</strong><br>
                ${pessoas.map(pessoa => `• ${pessoa}`).join('<br>')}
            `;
        }
        
        function testarEstatisticas() {
            const dados = DataStructure.inicializarDados();
            const stats = DataStructure.calcularEstatisticas(dados);
            const resultado = document.getElementById('resultadoDados');
            resultado.innerHTML = `
                <strong>Estatísticas:</strong><br>
                • Total de atividades: ${stats.total}<br>
                • Em dia: ${stats.emDia} (${Math.round(stats.emDia/stats.total*100)}%)<br>
                • Atenção: ${stats.atencao} (${Math.round(stats.atencao/stats.total*100)}%)<br>
                • Atraso: ${stats.atraso} (${Math.round(stats.atraso/stats.total*100)}%)
            `;
        }
        
        // ✅ TESTES DO SISTEMA DE PERSISTÊNCIA
        function testarSalvamentoPadrao() {
            const resultado = document.getElementById('resultadoPersistencia');
            resultado.innerHTML += '⏳ Testando salvamento padrão...<br>';
            
            // Garantir que App tem dados
            if (typeof App !== 'undefined' && !App.dados) {
                App.dados = DataStructure.inicializarDados();
                App.usuarioAtual = { email: 'teste@dev.com' };
                resultado.innerHTML += '📊 Dados inicializados para teste<br>';
            }
            
            Persistence.salvarDados().then(() => {
                resultado.innerHTML += '✅ Salvamento padrão executado<br>';
            }).catch(error => {
                resultado.innerHTML += `❌ Erro: ${error}<br>`;
            });
        }
        
        function testarSalvamentoCritico() {
            const resultado = document.getElementById('resultadoPersistencia');
            resultado.innerHTML += '⚡ Testando salvamento crítico...<br>';
            
            // Garantir que App tem dados
            if (typeof App !== 'undefined' && !App.dados) {
                App.dados = DataStructure.inicializarDados();
                App.usuarioAtual = { email: 'teste@dev.com' };
                resultado.innerHTML += '📊 Dados inicializados para teste<br>';
            }
            
            Persistence.salvarDadosCritico().then(() => {
                resultado.innerHTML += '✅ Salvamento crítico concluído<br>';
            }).catch(error => {
                resultado.innerHTML += `❌ Erro crítico: ${error}<br>`;
            });
        }
        
        function testarBackupLocal() {
            const resultado = document.getElementById('resultadoPersistencia');
            
            // Garantir que App tem dados
            if (typeof App !== 'undefined' && !App.dados) {
                App.dados = DataStructure.inicializarDados();
                resultado.innerHTML += '📊 Dados inicializados para teste<br>';
            }
            
            // Simular dados para backup
            const dadosTeste = App.dados || { teste: 'backup', timestamp: new Date().toISOString() };
            Persistence._salvarBackupLocal(dadosTeste);
            
            const backup = Persistence.recuperarBackupLocal();
            if (backup) {
                resultado.innerHTML += `✅ Backup local funcionando<br>Dados: ${backup.versao || 'N/A'}<br>`;
            } else {
                resultado.innerHTML += '❌ Nenhum backup local encontrado<br>';
            }
        }
        
        function testarStatusPersistencia() {
            const resultado = document.getElementById('resultadoPersistencia');
            const status = Persistence.obterStatus();
            
            resultado.innerHTML += `📊 Status do Sistema:<br>`;
            resultado.innerHTML += `• Operações em andamento: ${status.operacoesEmAndamento}<br>`;
            resultado.innerHTML += `• Dados para salvar: ${status.temDadosParaSalvar ? 'Sim' : 'Não'}<br>`;
            resultado.innerHTML += `• Tentativas: ${status.tentativasAtual}/3<br>`;
            resultado.innerHTML += `• Último backup: ${status.ultimoBackup || 'Nenhum'}<br>`;
        }
        
        function simularFalhaSalvamento() {
            const resultado = document.getElementById('resultadoPersistencia');
            resultado.innerHTML += '🚨 Simulando falha de salvamento...<br>';
            
            // Simular falha forçando modal de recuperação
            Persistence._mostrarOpcoesRecuperacao();
            resultado.innerHTML += '⚠️ Modal de recuperação exibido<br>';
        }
        
        async function testarConectividade() {
            const resultado = document.getElementById('resultadoPersistencia');
            resultado.innerHTML += '🌐 Verificando conectividade...<br>';
            
            try {
                const conectado = await Persistence.verificarConectividade();
                if (conectado) {
                    resultado.innerHTML += '✅ Firebase conectado<br>';
                } else {
                    resultado.innerHTML += '❌ Firebase desconectado<br>';
                }
            } catch (error) {
                resultado.innerHTML += `❌ Erro de conectividade: ${error.message}<br>`;
            }
        }
        
        // ✅ LOG INICIAL
        console.log('🔧 Index DEV v6.2 - Modo desenvolvimento carregado!');
        console.log('📦 Módulos disponíveis:', {
            Helpers: typeof Helpers !== 'undefined',
            Validation: typeof Validation !== 'undefined', 
            Notifications: typeof Notifications !== 'undefined',
            DataStructure: typeof DataStructure !== 'undefined',
            App: typeof App !== 'undefined',
            Persistence: typeof Persistence !== 'undefined',
            Auth: typeof Auth !== 'undefined'
        });
        
        // ✅ TESTE AUTOMÁTICO DE INICIALIZAÇÃO
        setTimeout(() => {
            Notifications.success('🚀 Sistema modular inicializado com sucesso!');
            
            // Inicializar dados do App para testes
            if (typeof App !== 'undefined' && typeof DataStructure !== 'undefined') {
                App.dados = DataStructure.inicializarDados();
                App.usuarioAtual = { email: 'teste@dev.com', displayName: 'Dev User' };
                console.log('📊 Dados de teste inicializados no App');
            }
            
            // Teste automático do sistema de persistência
            setTimeout(() => {
                const resultado = document.getElementById('resultadoPersistencia');
                if (resultado) {
                    resultado.innerHTML = '🔄 Executando testes automáticos...<br>';
                    
                    if (typeof Persistence !== 'undefined') {
                        resultado.innerHTML += '✅ Módulo Persistence carregado<br>';
                        
                        if (typeof App !== 'undefined') {
                            resultado.innerHTML += '✅ Módulo App carregado<br>';
                            
                            if (typeof Auth !== 'undefined') {
                                resultado.innerHTML += '✅ Módulo Auth carregado<br>';
                                
                                // Teste básico de status
                                const status = Persistence.obterStatus();
                                resultado.innerHTML += `📊 Status inicial: ${status.operacoesEmAndamento} operações<br>`;
                                
                                const authStatus = Auth.obterStatus();
                                resultado.innerHTML += `🔐 Auth: ${authStatus.autenticado ? 'Logado' : 'Não logado'}<br>`;
                            } else {
                                resultado.innerHTML += '❌ Módulo Auth não encontrado<br>';
                            }
                        } else {
                            resultado.innerHTML += '❌ Módulo App não encontrado<br>';
                        }
                    } else {
                        resultado.innerHTML += '❌ Módulo Persistence não encontrado<br>';
                    }
                }
            }, 2000);
        }, 1000);
    </script>
</body>
</html>
